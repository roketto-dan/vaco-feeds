---
import { Profile } from "./Profile";
import { type Post, posts, generatePostId } from "../modules/post";
import { formatDistanceToNowStrict } from "date-fns";
import { ko as koLocale } from "date-fns/locale/ko";
import { Focusing } from "./Focusing";
import Thumbnail from "./Thumbnail.astro";

const { class: classList } = Astro.props;
const recommandPosts: (Post & { comment: string })[] = [
  {
    ...posts.find((post) => post.id === generatePostId({ title: "ì›¹ ê°œë°œìì—ê²Œ ë¸Œë¼ìš°ì €ë€?" }))!,
    comment: "ì›¹ ê°œë°œìë¡œì„œ ë¸Œë¼ìš°ì €ì— ëŒ€í•´ ê³µë¶€í•˜ì‹  ë‚´ìš©ì„ ê¹Šì´ìˆê²Œ ì •ë¦¬í•´ì£¼ì‹  ê¸€ì…ë‹ˆë‹¤.",
  },
  {
    ...posts.find((post) => post.id === generatePostId({ title: "ë¦¬ì•¡íŠ¸ì—ì„œì˜ ë Œë”ë§ì´ë€ ë¬´ì—‡ì¼ê¹Œ?" }))!,
    comment: "í”„ë¡ íŠ¸ì•¤ë“œ ê°œë°œìê°€ ë˜ê¸° ìœ„í•´ ì—´ì‹¬íˆ ë¦¬ì•¡íŠ¸ë¥¼ ê³µë¶€í•˜ì‹œë©° ì •ë¦¬í•˜ì‹  ê¸€ë¡œ ë¦¬ì•¡íŠ¸ì—ì„œ ë§í•˜ëŠ” ë Œë”ë§ì´ë¼ëŠ” ë‹¨ì–´ì— ëŒ€í•´ ê¹Šì€ ì´í•´ë¥¼ í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ê¸€ì…ë‹ˆë‹¤.",
  },
  {
    ...posts.find((post) => post.id === generatePostId({ title: "ë‚´ README.mdì— ëª©ì°¨ë¥¼ ë„£ëŠ”ê±´ ê³„íšëŒ€ë¡œ ë˜ì§€ ì•Šì•„" }))!,
    comment: "ë¦¬ë“œë¯¸ë¥¼ ì‘ì„±í•  ë•Œ ëª©ì°¨ë¥¼ ì‰½ê³  ì •í™•í•˜ê²Œ ë„£ì„ ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì•Œë ¤ì£¼ëŠ” ê¸€ì…ë‹ˆë‹¤. íŠ¹íˆ ì·¨ì—…ì„ ìœ„í•´ í”„ë¡œì íŠ¸ ë¦¬ë“œë¯¸ë¥¼ ì‘ì„±í•˜ì‹¤ ë•Œ ìœ ìš©í•˜ì‹œë¦¬ë¼ ìƒê°ë©ë‹ˆë‹¤.",
  },
  {
    ...posts.find((post) => post.id === generatePostId({ title: "[React] ë¬´í•œ ë Œë”ë§ ì„œë°”ì´ë²Œ" }))!,
    comment: "ë¦¬ì•¡íŠ¸ì˜ ë Œë”ë§ê³¼ ì—¬ëŸ¬ í›…ì˜ ì—­í• ì„ 'ë¬´í•œ ë Œë”ë§' ì´ë¼ëŠ” ì„œë°”ì´ë²Œ í”„ë¡œê·¸ë¨ ì»¨ì…‰ìœ¼ë¡œ ì¬ë°Œê²Œ í’€ì–´ì£¼ì‹  ë‚´ìš©ì…ë‹ˆë‹¤."
  },
  {
    ...posts.find((post) => post.id === generatePostId({ title: "inputì˜ ê¸¸ì´ë¥¼ ë‚´ë¶€ ê°’ì— ë”°ë¼ ë™ì ìœ¼ë¡œ ì¡°ì ˆí•´ë³´ì" }))!,
    comment: "ë™ì˜ìƒ ìœ„ì— ê¸€ê·€ë¥¼ ì¶”ê°€í•˜ëŠ” ê¸°ëŠ¥ì„ ê°œë°œí•˜ëŠ” ê³¼ì •ì—ì„œ ê²ªì—ˆë˜ ê¸°ìˆ ì ì¸ ì±Œë¦°ì§€ë¥¼ ìƒìƒí•˜ê²Œ ê¸°ë¡í•´ì£¼ì…”ì„œ ì¬ë°Œê²Œ ì½ì—ˆìŠµë‹ˆë‹¤.",
  },
  {
    ...posts.find((post) => post.id === generatePostId({ title: "ë‹¤ì‹œ ìƒê°í•˜ëŠ” useEffect" }))!,
    comment: "ë¦¬ì•¡íŠ¸ì—ì„œ effectëŠ” ë„ë¦¬ ì“°ì´ëŠ” APIì´ì§€ë§Œ, ê·¸ì™€ ë™ì‹œì— ì°¸ ê¸°ì´í•œ ì¡´ì¬ê¸°ë„í•˜ì£ . ì´ ê¸€ì€ ë¦¬ì•¡íŠ¸ì™€ effectê°€ ì–´ë–»ê²Œ ë§Œë“¤ì–´ì¡ŒëŠ”ì§€ ì§šì–´ë³´ë©° ê·¸ ì˜ë¯¸ë¥¼ ë‹¤ì‹œê¸ˆ ì¼ê¹¨ì›Œì£¼ëŠ” ê¸€ì…ë‹ˆë‹¤."
  },
  {
    ...posts.find((post) => post.id === generatePostId({ title: "ì‹±ê°€í¬ë¥´ì˜ ê°ì¢… ì½”ì›Œí‚¹ ìŠ¤í˜ì´ìŠ¤ í›„ê¸°" }))!,
    comment: "ë””ì§€í„¸ ë…¸ë§ˆë“œ ìƒí™œì„ í•˜ì…¨ë˜ ì˜êµë‹˜ì´ ì‹±ê°€í¬ë¥´ì—ì„œ ì—¬ëŸ¬ ì½”ì›Œí‚¹ ìŠ¤í˜ì´ìŠ¤ë“¤ì„ ê²½í—˜í•˜ê³  ëŠë¼ì‹  ê²ƒë“¤ì„ ê³µìœ í•´ì£¼ì‹  í¬ìŠ¤íŠ¸ë¡œ, ë””ì§€í„¸ ë…¸ë§ˆë“œ ìƒí™œì„ ê°„ì ‘ì ìœ¼ë¡œ ê²½í—˜í•´ë³¼ ìˆ˜ ìˆëŠ” ì¬ë°ŒëŠ” ë‚´ìš©ì´ë¼ ìƒê°í•©ë‹ˆë‹¤.",
  },
];
---
<section class={`${classList}`}>
  <div>
    <p class="px-2 text-lg font-bold md:text-xl">ì´ ì£¼ì˜ ì¶”ì²œê¸€ 
      <Focusing client:load>
        <span class="inline-block animate-wiggle">ğŸ“</span>
      </Focusing>
    </p>
    <p class="mt-[2px] px-2 text-[12px] text-[#616161] md:text-[14px]">
      ê¹Šì€ ê³ ë¯¼ì´ ë‹ë³´ì´ëŠ” ê¸€ì„ ì°¾ì•„ ë§¤ ì£¼ í•˜ë‚˜ì˜ ê¸€ì„ ì¶”ì²œí•´ë“œë¦½ë‹ˆë‹¤.
    </p>
  </div>

  <!-- Post Slider Section(Mobile) -->
  <div class="block md:hidden">
    <swiper-container class="mt-4" init="false">
      {recommandPosts.map((post) => (
        <swiper-slide class="group w-[calc(100%-((12px+20px)*2))]">
          <a href={post.link} class="opacity-60 group-[.swiper-slide-active]:opacity-100">
            <Thumbnail post={post} width={384} height={216} className="w-full aspect-video rounded-xl" />
            <div class="hidden group-[.swiper-slide-active]:block">
              <p class="mt-3 text-xl font-bold text-ellipsis overflow-hidden line-clamp-2">{post.title}</p>
              <div class="mt-4 flex items-center gap-1 text-sm text-[#3B3B3B]">
                <Profile userName={post.user} />
                |
                <time datetime={new Date(post.date).toISOString()} class="text-sm text-nowrap">
                  {formatDistanceToNowStrict(new Date(post.date), { addSuffix: true, locale: koLocale })}
                </time>
              </div>
              <p class="mt-3 text-[14px] leading-[22px] text-[#616161]">{post.comment}</p>
            </div>
          </a>
        </swiper-slide>
      ))}
    </swiper-container>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-element-bundle.min.js"></script>
    <script is:inline type="module">
      const swiperEl = document.querySelector('swiper-container');
      const params = {
        navigation: true,
        loop: true,
        grabCursor: true,
        centeredSlides: true,
        slidesPerView: 'auto',
        spaceBetween: 12,
        autoplay: {
          delay: 5000,
          disableOnInteraction: false,
        },
        injectStyles: [
          `
          .swiper-wrapper {
            height: 380px;
          }
          .swiper-button-prev,
          .swiper-button-next {
            width: 32px;
            height: 100%;
            position: absolute;
            top: 0;
            margin: 0;
          }
          .swiper-button-prev,
          .swiper-button-next svg {
            display: none;
          }
          .swiper-button-prev {
            left: 0;
          }
          .swiper-button-next {
            right: 0;
          }
          `,
        ],
      };
      Object.assign(swiperEl, params);
      swiperEl.initialize();
    </script>
  </div>

  <!-- 1 + 2 Post Section(Desktop) -->
  <ul class="hidden md:flex justify-between mt-6">
    <li class="w-[384px]">
      <a href={recommandPosts[0].link}>
        <Thumbnail post={recommandPosts[0]} width={384} height={216} className="rounded-[20px]" />
        <p class="mt-3 text-2xl font-bold text-ellipsis overflow-hidden line-clamp-2">{recommandPosts[0].title}</p>
        <div class="mt-4 flex items-center gap-1 text-sm text-[#3B3B3B]">
          <Profile userName={recommandPosts[0].user} />
          |
          <time datetime={new Date(recommandPosts[0].date).toISOString()} class="text-sm text-nowrap">
            {formatDistanceToNowStrict(new Date(recommandPosts[0].date), { addSuffix: true, locale: koLocale })}
          </time>
        </div>
        <p class="mt-3 text-[14px] text-[#616161] break-keep">{recommandPosts[0].comment}</p>
      </a>
    </li>
    {recommandPosts.slice(1, 3).map((post) => (
      <li class="w-[192px]">
        <a href={post.link}>
          <Thumbnail post={post} width={192} height={144} className="rounded-xl" />
          <p class="mt-3 text-lg font-bold text-ellipsis overflow-hidden line-clamp-2">{post.title}</p>
          <div class="mt-4 flex items-center gap-1 text-sm text-[#3B3B3B]">
            <Profile userName={post.user} />
            |
            <time datetime={new Date(post.date).toISOString()} class="text-sm text-nowrap">
              {formatDistanceToNowStrict(new Date(post.date), { addSuffix: true, locale: koLocale })}
            </time>
          </div>
          <p class="mt-3 text-[14px] text-[#616161] break-keep">{post.comment}</p>
        </a>
      </li>
    ))}
  </ul>
</section>
